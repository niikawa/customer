var segmentServices=angular.module("SegmentServices",["ngResource"]);segmentServices.factory("Segment",["$resource","$http","Utility",function(a){var b={};return b.resource=a("/segment/:id/",{id:"@id"},{getDoc:{method:"GET",url:"segment/getdoc"},saveDoc:{method:"POST",url:"segment/savedoc"},save:{method:"POST",url:"segment/save"},download:{method:"GET",url:"segment/:id/download"},remove:{method:"DELETE",url:"segment/remove/:id/:segment_document_id"},executeQuery:{method:"POST",url:"segment/execute"},useSegment:{method:"POST",url:"/segment/query/use"}}),b.pageProp=function(a){return void 0===a?{viewMode:1,pageTitle:"登録"}:{viewMode:2,pageTitle:"更新"}},b.setWhereProp=function(a,b){void 0===b?angular.forEach(a,function(a){a.where="AND"}):angular.forEach(a,function(a,c){var d=null===b[c]?"AND":b[c];a.where=d})},b.setListData=function(a,b,c){angular.forEach(b,function(b){angular.forEach(a,function(d,e){b==d.id&&(c.push(d),a.splice(e,1))})})},b.createExecuteInfo=function(a){var b=[],c={},d={};return angular.forEach(a,function(a){b.push(a.id),c[a.id]=a.where,Object.keys(a.tables).forEach(function(a){d.hasOwnProperty(a)||(d[a]=a)})}),{qIds:b,tables:d,conditionMap:c}},b.createSQL=function(a){var b="",c=a.length-1;return angular.forEach(a,function(a,d){b+="("+a.sql+") ",c!==d&&(b+=a.where)}),b},b.getTables=function(a){var b={};return angular.forEach(a,function(a){Object.keys(a.tables).forEach(function(a){b.hasOwnProperty(a)||(b[a]=a)})}),b},b.createDocData=function(a){var b="",c=a.length-1,d=[],e=[];return angular.forEach(a,function(a,f){b+="("+a.sql+") ",c!==f&&(b+=a.where),d.push(a.id),e.push(a.where)}),{condition:b,qIds:d,whereList:e}},b}]);