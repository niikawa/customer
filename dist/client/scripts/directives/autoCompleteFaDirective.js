var myApp=angular.module("myApp");myApp.directive("autoCompleteFaDirective",function(){return{restrict:"E",scope:{selectedItem:"=",itemList:"=",execute:"&",clickExecute:"&",namePropertie:"@",appendString:"@",showLabel:"=",selectByList:"=",selectName:"=",addonString:"@"},template:'<div class="input-group"><span class="input-group-addon">{{addonString}}</span><input ng-show="!isLabel" class="form-control form-control-add-fa2 " ng-model="selectName"><span ng-show="isLabel && selectName.length != 0" ng-click="changeElement()">{{appendString}}{{selectName}}</span><ul class="complete-list" ng-show="isFocus"><li ng-repeat="item in itemList" ng-click="click($event, item)" >{{item[namePropertie]}}</li></ul><span class="input-group-addon question"><i class="fa fa-plus fa-2x" ng-click="clickI()"></i></span>',replace:!0,link:function(a,b){a.selectName="",a.isFocus=!1,a.isLabel=!1;var c=[];a.$watch("itemList",function(b,d){if(void 0!==b&&void 0!==d){if(console.log("watch itemList"),b.length===d.length)return!1;b.length>d.length?c=angular.copy(b):b.length<d.length&&(c=angular.copy(d))}else void 0!==a.itemList&&(console.log("set initialize data"),angular.copy(a.itemList,c))}),b.find("input").on("focus",function(){0<a.itemList.length&&a.$apply(function(){a.isFocus=!0})}),b.find("input").on("blur",function(){var d=setInterval(function(){a.$apply(function(){if(a.selectByList){for(var d=c.length,e=0===a.selectName.length?!0:!1,f=0;d>f;f++)if(a.selectName===c[f][a.namePropertie]){e=!0;break}e?b.find("input").removeClass("auto-complete-item-error"):b.find("input").addClass("auto-complete-item-error"),a.isFocus=!1}}),clearInterval(d)},300)}),b.find("input").on("keyup",function(){0===c.length&&angular.copy(a.itemList,c);var b=[];if(0<a.itemList.length&&(a.isFocus=!0),0===a.selectName.length)angular.copy(c,b);else for(var d=c.length,e=0;d>e;e++)-1!==c[e][a.namePropertie].indexOf(a.selectName)&&b.push(angular.copy(c[e]));a.$apply(function(){angular.copy(b,a.itemList)})}),a.click=function(c,d){c.preventDefault(),c.stopPropagation(),angular.copy(d,a.selectedItem),b.find("input").removeClass("auto-complete-item-error"),a.isFocus=!1,void 0!==a.execute&&a.execute(),a.showLabel&&(a.isLabel=!0),a.selectName=d[a.namePropertie]},a.changeElement=function(){angular.copy(c,a.itemList),a.isLabel=!1,b.find("input").focus()},a.clickI=function(){angular.copy(c,a.itemList),a.isFocus=!1,a.clickExecute()}}}});