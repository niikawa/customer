var myApp=angular.module("myApp");myApp.directive("conditionDirective",function(a){return{restrict:"EA",scope:{conditionAppend:"=",screenType:"@"},template:'指定した値<select ng-model="mySlected" class="form-control" ng-options="item as item.name for item in selectItems" ng-required="true"></select>ものを条件とする<div ng-if="isOneInput"><input type="text" name="{{conditionAppend.column.physicalname}}" class="form-control" ng-model="conditionAppend.condition.value1" ng-keyup="check()" ng-required="true"><div ng-if="conditionAppend.error" class="item-error-box"><p class="item-error">{{conditionAppend.message}}</p></div></div><div ng-if="isTextArea"><textarea class="form-control" ng-model="conditionAppend.condition.value1" ng-required="true"></textarea></div><div ng-if="isTwoInput"><input type="text" class="form-control" ng-model="conditionAppend.condition.value1" ng-keyup="check()" ng-required="true">～<input type="text" class="form-control" ng-model="conditionAppend.condition.value2" ng-keyup="check()" ng-required="true"></div>',link:function(b,c){var d=function(){b.isOneInput=!0,b.isTextArea=!1,b.isTwoInput=!1},e=function(){b.isOneInput=!1,b.isTextArea=!0,b.isTwoInput=!1},f=function(){b.isOneInput=!1,b.isTextArea=!1,b.isTwoInput=!0};b.selectItems=1==b.screenType?[{name:"に等しい",value:1,execute:d,symbol:"="},{name:"以上",value:2,execute:d,symbol:">="},{name:"以下",value:3,execute:d,symbol:"<="},{name:"を超える",value:4,execute:d,symbol:">"},{name:"未満",value:5,execute:d,symbol:"<"},{name:"の間",value:6,execute:f,symbol:"BETWEEN"}]:[{name:"に等しい",value:1,execute:d,symbol:"="},{name:"以上",value:2,execute:d,symbol:">="},{name:"以下",value:3,execute:d,symbol:"<="},{name:"を超える",value:4,execute:d,symbol:">"},{name:"未満",value:5,execute:d,symbol:"<"},{name:"の間",value:6,execute:f,symbol:"BETWEEN"},{name:"を含む",value:7,execute:e,symbol:"IN"},{name:"を含まない",value:8,execute:e,symbol:"NOT IN"},{name:"から始まる",value:9,execute:d,symbol:"LIKE"},{name:"で終わる",value:10,execute:d,symbol:"LIKE"},{name:"を一部に持つ",value:11,execute:d,symbol:"LIKE"}],b.isOneInput=!1,b.isTextArea=!1,b.isTwoInput=!1,void 0===b.conditionAppend.selectedCondition?(b.conditionAppend.selectedCondition={name:"",value:"",symbol:""},b.conditionAppend.condition={value1:"",value2:"",where:"AND"}):angular.forEach(b.selectItems,function(a){return a.value===b.conditionAppend.selectedCondition.value?(b.mySlected=a,b.conditionAppend.selectedCondition.name=b.mySlected.name,b.conditionAppend.selectedCondition.value=b.mySlected.value,b.conditionAppend.selectedCondition.symbol=b.mySlected.symbol,a.execute(),!1):void 0}),c.find("select").on("change",function(){b.conditionAppend.selectedCondition.name=b.mySlected.name,b.conditionAppend.selectedCondition.value=b.mySlected.value,b.conditionAppend.selectedCondition.symbol=b.mySlected.symbol,b.$apply(function(){b.mySlected.execute()})}),b.check=function(){var c="";c=void 0===b.conditionAppend.column?b.conditionAppend.type:b.conditionAppend.column.type;var d=b.conditionAppend.condition.value1;if("bigint"===c||"int"===c||"number"===c)void 0===d?(b.conditionAppend.error=!1,b.conditionAppend.message=""):isFinite(parseInt(d,10))?(b.conditionAppend.error=!1,b.conditionAppend.message=""):(b.conditionAppend.error=!0,b.conditionAppend.message="数値で入力してください");else if("datetime"===c||"smalldatetime"===c)if(void 0===d)b.conditionAppend.error=!1,b.conditionAppend.message="";else{var e=d.split("-");if(3!==e.length)b.conditionAppend.error=!0,b.conditionAppend.message="日付はYYYY-MM-DDで入力してください";else{var f=a.moment(d);f.isValid()?(b.conditionAppend.error=!1,b.conditionAppend.message=""):(b.conditionAppend.error=!0,b.conditionAppend.message="有効な日付ではありません")}}}}}});