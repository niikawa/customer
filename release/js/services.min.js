var locationServices=angular.module("myApp");locationServices.service("Location",["$location",function(a){var b={};return b.home=function(){a.path("/")},b.user=function(){a.path("/user")},b.query=function(){a.path("/query")},b.query=function(){a.path("/query/list")},b.querySet=function(){a.path("/query/set")},b.querySave=function(){a.path("/query/save")},b.segment=function(){a.path("/segment")},b.segmentControl=function(b){a.path("/segment/control/"+b)},b.trigger=function(){a.path("/scenario/trigger")},b.schedule=function(){a.path("/scenario/schedule")},b}]);var mainServices=angular.module("myApp");mainServices.service("Main",function(){var a={};return a.getUserIdFromList=function(a,b){return a[b].my._id},a.getTaskIdFromList=function(a,b,c){return a[b].taskList[c]._id},a.removeTaskByIndex=function(a,b,c){a[b].taskList.splice(c,1)},a.getProgressFromList=function(a,b,c){return a[b].taskList[c].progress},a.getContentsFromList=function(a,b,c){return a[b].taskList[c].contents},a});var customerServices=angular.module("CustomerServices",["ngResource"]);customerServices.factory("Customer",["$resource","Utility",function(a){var b={};return b.resource=a("/customer/:id/",{id:"@id"},{detail:{method:"GET",url:"custmoer/detail/:id",cache:!0},orders:{method:"GET",url:"custmoer/orders/:id",cache:!0}}),b}]);var scenarioServices=angular.module("ScenarioServices",["ngResource"]);scenarioServices.factory("Scenario",["$resource","$http","$q","Utility",function(a,b,c){var d={},e={schedule:{type:1,mode:0,title:"スケジュール型",addTitle:"",template:"views/scenario/schedule.html"},trigger:{type:2,mode:0,title:"トリガー型",addTitle:"",template:"views/scenario/trigger.html"}};return d.daysCondition=function(){for(var a=[],b=31,c=1;b>=c;c++)a.push({name:c,check:!1});return a.push({name:"最終日",check:!1}),a},d.resource=a("/scenario/:type/:id/",{id:"@id"},{list:{method:"GET",url:"scenario/list/:id",cache:!0},initializeData:{method:"GET",url:"scenario/initialize/:type/:id"},action:{method:"GET",url:"action/:name",cache:!0},save:{method:"POST",url:"scenario/save"},remove:{method:"DELETE",url:"scenario/:type/remove/:id"},valid:{method:"GET",url:"scenario/valid"},priority:{method:"POST",url:"scenario/priority"},typeCount:{method:"GET",url:"scenario/typecount"},executeplan:{method:"GET",url:"scenario/execute/plan"},bulkInvalid:{method:"GET",url:"scenario/bulkInvalid"},bulkEnable:{method:"GET",url:"scenario/bulkEnable"}}),d.getPageProp=function(a,b){var c=e[a];return c.addTitle=void 0===b?"登録":"更新",c.mode=void 0===b?1:2,c},d.validators={isSameName:function(a){return b.post("scenario/name/",a).then(function(a){return a.data.result.count>0?c.reject("exists"):!1})}},d.setActivePushItem=function(a,b,c,d){angular.forEach(a,function(a){return a.isPush?(c[d]=a[b],!1):void 0})},d.createCondtionString=function(a){var b="",c=a.length-1;return angular.forEach(a,function(a,d){b+=a.logicalname+"が["+a.condition.value1,""!==a.condition.value2&&(b+=","+a.condition.value2),b+="]"+a.selectedCondition.name,d!==c&&(b+="AND"===a.condition.where?" かつ ":" または ")}),b},d.getConditionDoc=function(a){var b=[];return angular.forEach(a,function(a){var c=[];angular.forEach(a,function(a){c.push({physicalname:a.physicalname,condition:a.condition,selectedCondition:a.selectedCondition})}),b.push(c)}),b},d}]);var segmentServices=angular.module("SegmentServices",["ngResource"]);segmentServices.factory("Segment",["$resource","$http","Utility",function(a){var b={};return b.resource=a("/segment/:id/",{id:"@id"},{getDoc:{method:"GET",url:"segment/getdoc"},saveDoc:{method:"POST",url:"segment/savedoc"},save:{method:"POST",url:"segment/save"},download:{method:"GET",url:"segment/:id/download"},remove:{method:"DELETE",url:"segment/remove/:id/:segment_document_id"},executeQuery:{method:"POST",url:"segment/execute"},useSegment:{method:"POST",url:"/segment/query/use"}}),b.pageProp=function(a){return void 0===a?{viewMode:1,pageTitle:"登録"}:{viewMode:2,pageTitle:"更新"}},b.setWhereProp=function(a,b){void 0===b?angular.forEach(a,function(a){a.where="AND"}):angular.forEach(a,function(a,c){var d=null===b[c]?"AND":b[c];a.where=d})},b.setListData=function(a,b,c){angular.forEach(b,function(b){angular.forEach(a,function(d,e){b==d.id&&(c.push(d),a.splice(e,1))})})},b.createExecuteInfo=function(a){var b=[],c={},d={};return angular.forEach(a,function(a){b.push(a.id),c[a.id]=a.where,Object.keys(a.tables).forEach(function(a){d.hasOwnProperty(a)||(d[a]=a)})}),{qIds:b,tables:d,conditionMap:c}},b.createSQL=function(a){var b="",c=a.length-1;return angular.forEach(a,function(a,d){b+="("+a.sql+") ",c!==d&&(b+=a.where)}),b},b.getTables=function(a){var b={};return angular.forEach(a,function(a){Object.keys(a.tables).forEach(function(a){b.hasOwnProperty(a)||(b[a]=a)})}),b},b.createDocData=function(a){var b="",c=a.length-1,d=[],e=[];return angular.forEach(a,function(a,f){b+="("+a.sql+") ",c!==f&&(b+=a.where),d.push(a.id),e.push(a.where)}),{condition:b,qIds:d,whereList:e}},b}]);var queryServices=angular.module("QueryServices",["ngResource"]);queryServices.factory("Query",["$resource","$http","Shared",function(a,b,c){var d={};return d.sql="",d.resource=a("/query",{id:"@id"},{getQuery:{method:"GET",url:"/query/get"},getList:{method:"GET",url:"/query/list"},getControlInit:{method:"GET",url:"/query/control/:id"},create:{method:"POST",url:"/query/create"},remove:{method:"DELETE",url:"/query/:id"},getUseSegment:{method:"GET",url:"/query/use/segment/:id"},executeQuery:{method:"POST",url:"/query/execute"}}),d.getContentsByColumsType=function(a){var b={inputType:""};return console.log(a),"INT"===a?b.inputType="number":"VARCHAR"===a?b.inputType="text":"DATETIME"===a&&(b.inputType="date"),b.inputType},d.createCondtionString=function(a){angular.forEach(a,function(a){a.selectedCondition.condtionString=void 0===a.condition.value2||""===a.condition.value2?a.condition.value1+""+a.selectedCondition.name:a.condition.value1+"から"+a.condition.value2+a.selectedCondition.name})},d.getTables=function(a){var b={};return angular.forEach(a,function(a){void 0===b[a.table.physicalname]&&(b[a.table.physicalname]=[]);var c={column:a.column.physicalname,conditionType:a.selectedCondition.value,values:a.condition};b[a.table.physicalname].push(c)}),b},d.getRefTabels=function(a){var b=[];return angular.forEach(a,function(a){b.push(a)}),b},d.getReturnURL=function(){var a=c.getRoot(),b=a.length,d=a[a.length-1],e="";if("query list"===d)e="/query/list";else if("query list"===d)e="/segment/control";else for(b;b>0;b--){if("query list"===a[b]){e="/query/list";break}if("segment control"===a[b]){e="/segment/control";break}}return e},d}]);var approachServices=angular.module("ApproachServices",["ngResource"]);approachServices.factory("Approach",["$resource","Utility",function(a){var b={};return b.resource=a("/approach/"),b.pageProp=function(a){return void 0===a?{viewMode:1,pageTitle:"登録"}:{viewMode:2,pageTitle:"更新"}},b.getInfomation=function(a){var b={};return 1===a?(b.title="1日の制限回数について",b.message="対象の顧客に対して1日に抽出対象とする回数になります。<br>複数のシナリオで抽出対象となる顧客の場合この回数以上は抽出されなくなります。"):2===a&&(b.title="1週間の制限回数について",b.message="対象の顧客に対して1週間に抽出対象とする回数"),b},b}]);var uesrServices=angular.module("UesrServices",["ngResource"]);uesrServices.factory("User",["$resource","$http","$q","Utility",function(a,b,c){var d={},e={regist:{type:1,title:"ユーザー登録"},edit:{type:2,title:"ユーザー更新"}};return d.resource=a("/user/:id",{id:"@id"},{create:{method:"POST",url:"user/create"},remove:{method:"GET",url:"user/delete"}}),d.validators={isSameMailAddress:function(a,d){return b.post("user/mail/",{user_id:a,mailaddress:d}).then(function(a){return a.data.result.count>0?c.reject("exists"):!1})}},d.createBirth=function(a,b,c){return""!==a&&""!==b&&""!==c?a+"-"+b+"-"+c:""},d.getPrefectures=function(){return[{value:"01",text:"北海道"},{value:"02",text:"青森"},{value:"03",text:"岩手"},{value:"04",text:"宮城"},{value:"05",text:"秋田"},{value:"06",text:"山形"},{value:"07",text:"福島"},{value:"08",text:"茨城"},{value:"09",text:"栃木"},{value:"10",text:"群馬"},{value:"11",text:"埼玉"},{value:"12",text:"千葉"},{value:"13",text:"東京"},{value:"14",text:"神奈川"},{value:"15",text:"新潟"},{value:"16",text:"富山"},{value:"17",text:"石川"},{value:"18",text:"福井"},{value:"19",text:"山梨"},{value:"20",text:"長野"},{value:"21",text:"岐阜"},{value:"22",text:"静岡"},{value:"23",text:"愛知"},{value:"24",text:"三重"},{value:"25",text:"滋賀"},{value:"26",text:"京都"},{value:"27",text:"大阪"},{value:"28",text:"兵庫"},{value:"29",text:"奈良"},{value:"30",text:"和歌山"},{value:"31",text:"鳥取"},{value:"32",text:"島根"},{value:"33",text:"岡山"},{value:"34",text:"広島"},{value:"35",text:"山口"},{value:"36",text:"徳島"},{value:"37",text:"香川"},{value:"38",text:"愛媛"},{value:"39",text:"高知"},{value:"40",text:"福岡"},{value:"41",text:"佐賀"},{value:"42",text:"長崎"},{value:"43",text:"熊本"},{value:"44",text:"大分"},{value:"45",text:"宮崎"},{value:"46",text:"鹿児島"},{value:"47",text:"沖縄"}]},d.getPageProp=function(a){return void 0===a?e.regist:e.edit},d.getSelectedUserIdAndML=function(a,b){for(var c=[],d=a.length,e=0;d>e;e++)a[e][b]&&c.push({_id:a[e]._id,mailAddress:a[e].mailAddress});return c},d}]);var roleServices=angular.module("RoleServices",["ngResource"]);roleServices.factory("Role",["$resource","Utility",function(a){var b={};return b.resource=a("/role/:id",{id:"@id"},{}),b}]);var accessServices=angular.module("AccessServices",["ngResource"]);accessServices.factory("Access",["$resource","Utility",function(a){var b={};return b.resource=a("/access/",{},{day:{method:"POST",url:"/access"},dayByUser:{method:"POST",url:"/access/user"}}),b}]);var bugServices=angular.module("BugServices",["ngResource"]);bugServices.factory("Bug",["$resource","Utility","Upload",function(a,b,c){var d={};return d.categoryList=[{name:"ダッシュボード",type:1},{name:"トリガーシナリオ管理",type:2},{name:"スケジュールシナリオ管理",type:3},{name:"セグメント管理",type:4},{name:"クエリー管理",type:5},{name:"アプローチ管理",type:6},{name:"ユーザー管理",type:7},{name:"操作履歴",type:8},{name:"その他",type:99}],d.resource=a("/bug/",{},{getByConditon:{method:"POST",url:"/bug"},resolve:{method:"GET",url:"/bug/resolve/:id"},save:{method:"POST",url:"/bug/save"},saveComment:{method:"POST",url:"/bug/save/comment"},getComment:{method:"GET",url:"/bug/comment/:id"},vote:{method:"GET",url:"/bug/vote/:id"},download:{method:"GET",url:"/bug/download/:id"}}),d.commentSaveAndUpload=function(a,b,d){c.upload({url:"/bug/save/comment/upload/",file:a,data:{data:b}}).success(function(){d(null)}).error(function(){d("通信エラー")})},d.saveAndUpload=function(a,b,d){c.upload({url:"/bug/save/upload/",file:a,data:{data:b}}).success(function(){d(null)}).error(function(){d("通信エラー")})},d.addViewInfo=function(a){angular.forEach(a,function(a){switch(a.category){case 1:a.category_name="ダッシュボード";break;case 2:a.category_name="トリガーシナリオ管理";break;case 3:a.category_name="スケジュールシナリオ管理";break;case 4:a.category_name="セグメント管理";break;case 5:a.category_name="クエリー管理";break;case 6:a.category_name="アプローチ管理";break;case 7:a.category_name="ユーザー管理";break;case 8:a.category_name="操作履歴";break;default:a.category_name="その他"}a.type_name=1===a.type?"要望":"バグ",a.resolve_name=1===a.resolve?"解決":"未解決"})},d}]);var azureServices=angular.module("AzureServices",["ngResource"]);azureServices.factory("Azure",["$resource","$http","Shared",function(a){var b={};return b.resource=a("/customer/:id/",{id:"@id"},{recomender:{method:"GET",url:"/azure/recomender/:id"}}),b}]);