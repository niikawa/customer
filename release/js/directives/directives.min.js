var myApp=angular.module("myApp");myApp.controller("CalendarCtrl",["$scope","Calendar","Utility",function(a,b,c){a.calendarList=[],a.calendarofMonthList=[],a.isWeek=!1,a.isMonth=!1;var d=!1;a.initialize=function(){b.resource.get().$promise.then(function(b){a.isWeek=!0,a.calendarList=b.data})},a.nextDay=function(){if(!d){d=!0;var e=Object.keys(a.calendarList),f=c.moment(e[e.length-1]).format("YYYY-MM-DD"),g=c.addDay(f,1).format("YYYY-MM-DD");b.resource.oneDay({day:g}).$promise.then(function(b){delete a.calendarList[Object.keys(a.calendarList)[0]];var c=Object.keys(b.data);a.calendarList[c]=b.data[c],d=!1})}},a.deforeDay=function(){if(!d){d=!0;var e=c.moment(Object.keys(a.calendarList)[0]).format("YYYY-MM-DD"),f=c.subtractDay(e,1).format("YYYY-MM-DD");b.resource.oneDay({day:f}).$promise.then(function(b){var c=Object.keys(a.calendarList);delete a.calendarList[c[c.length-1]];var e=Object.keys(b.data),f={};f[e]=b.data[e],Object.keys(a.calendarList).forEach(function(b){f[b]=a.calendarList[b]}),a.calendarList=f,d=!1})}},a.showWeek=function(){d||(d=!0,b.resource.get().$promise.then(function(b){d=!1,a.isWeek=!0,a.isMonth=!1,a.calendarList=b.data}))},a.showMonth=function(){if(!d){d=!0;var e=Object.keys(a.calendarList),f=c.moment(e[e.length-1]).format("YYYY"),g=c.moment(e[e.length-1]).format("MM");b.resource.month({year:f,month:g}).$promise.then(function(b){d=!1,a.isMonth=!0,a.isWeek=!1,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}},a.nextMonth=function(){if(!d){d=!0;var e=a.year+"/"+a.month+"/01",f=c.addMonth(e,1).format("YYYY-MM"),g=f.split("-");b.resource.month({year:g[0],month:g[1]}).$promise.then(function(b){d=!1,a.isWeek=!1,a.isMonth=!0,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}},a.deforeMonth=function(){if(!d){d=!0;var e=a.year+"/"+a.month+"/01",f=c.subtractMonth(e,1).format("YYYY-MM"),g=f.split("-");b.resource.month({year:g[0],month:g[1]}).$promise.then(function(b){d=!1,a.isWeek=!1,a.isMonth=!0,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}}}]),myApp.factory("Calendar",["$resource","Utility",function(a){var b={};return b.resource=a("/calendar/",{},{oneDay:{method:"GET",url:"calendar/one/:day"},month:{method:"GET",url:"calendar/:year/:month"}}),b}]),myApp.directive("calendarDirective",["Utility",function(a){return{restrict:"E",templateUrl:"../../partials/calendar.html",controller:"CalendarCtrl",link:function(b){b.showCircle=!1,b.enterCircle=function(){b.showCircle=!0},b.leaveCircle=function(){b.showCircle=!1},b.isTrigger=function(a){return 1===a},b.isScSingle=function(a){return 2===a},b.isScPriod=function(a){return 3===a},b.isHoliday=function(a){return"0sun"==a},b.isHolidayToWeek=function(b){return 0==a.moment(b).format("e")}}}}]);