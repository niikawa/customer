var utilsServices=angular.module("myApp");utilsServices.service("Utility",["$rootScope",function(a){this.deleteCommonInfo=function(a){angular.isArray(a)?angular.forEach(a,function(a){a.hasOwnProperty("delete_flag")&&delete a.delete_flag,a.hasOwnProperty("create_by")&&delete a.create_by,a.hasOwnProperty("create_date")&&delete a.create_date,a.hasOwnProperty("update_by")&&delete a.update_by,a.hasOwnProperty("update_date")&&delete a.update_date}):(a.hasOwnProperty("delete_flag")&&delete a.delete_flag,a.hasOwnProperty("create_by")&&delete a.create_by,a.hasOwnProperty("create_date")&&delete a.create_date,a.hasOwnProperty("update_by")&&delete a.update_by,a.hasOwnProperty("update_date")&&delete a.update_date)},this.info=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!1,position:b,type:"notice"})},this.infoSticky=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!0,position:b,type:"notice"})},this.warning=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!1,position:b,type:"warning"})},this.warningSticky=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!0,position:b,type:"warning"})},this.error=function(a,b){b=null==b?"top-center":b;var c=0===a.trim().length?"通信エラー":a;$().toastmessage("showToast",{text:c,sticky:!1,position:b,type:"error"})},this.errorSticky=function(a,b){b=null==b?"top-center":b;var c=0===a.trim().length?"通信エラー":a;$().toastmessage("showToast",{text:c,sticky:!0,position:b,type:"error"})},this.success=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!1,position:b,type:"success"})},this.successSticky=function(a,b){b=null==b?"top-center":b,$().toastmessage("showToast",{text:a,sticky:!0,position:b,type:"success"})},this.momentDefault=function(){return moment()},this.moment=function(a){return moment(a)},this.today=function(a){var b=null==a?"YYYY-MM-DD":a;return this.moment().format(b)},this.formatString=function(a,b){var c=null==b?"YYYY-MM-DD":b;return this.moment(a).format(c)},this.dayInMonth=function(a){return moment(a).daysInMonth()},this.isAfter=function(a,b){return moment(a).isAfter(moment(b))},this.getMomemtObject=function(a){return moment(a)},this.addDay=function(a,b){return moment(a).add(b,"day")},this.addMonth=function(a,b){return moment(a).add(b,"month")},this.addYear=function(a,b){return moment(a).add(b,"year")},this.subtractDay=function(a,b){return moment(a).subtract("day",b)},this.subtractMonth=function(a,b){return moment(a).subtract("month",b)},this.subtractYear=function(a,b){return moment(a).subtract("year",b)},this.diffDay=function(a,b){return moment(a).diff(moment(b),"day")},this.diffMonth=function(a,b){return moment(a).diff(moment(b),"month")},this.diffYear=function(a,b){return moment(a).diff(moment(b),"year")},this.createDayList=function(a){for(var b=[],c=1;a>=c;c++){var d=("00"+c).slice(-2);b.push({value:d,text:d})}return b},this.createMonthList=function(){for(var a=[],b=1;12>b;b++){var c=("00"+b).slice(-2);a.push({value:c,text:c})}return a},this.createYearList=function(a,b){for(var c=[],d=a;b>=d;d++)c.push({value:String(d),text:d});return c},this.setSpinner=function(b){a.$broadcast(b?"requestStart":"requestEnd")},this.isDateValid=function(a,b){if(null===a)return!1;void 0===b&&(b="-");var c=a.split(b);if(3!==c.length)return!1;var d=this.moment(a);return d.isValid()},this.confirmAlert=function(a){swal({title:"削除してもよろしいですか？",type:"warning",allowOutsideClick:!0,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"削除する",cancelButtonText:"キャンセル",closeOnConfirm:!0,html:!1},function(){a()})},this.infoAlert=function(a){swal({title:a.title,text:a.text,type:"info",allowOutsideClick:!0,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:a.confirmButtonText,cancelButtonText:"閉じる",closeOnConfirm:!0,html:!0},function(){a.execute()})}}]);var sharedServices=angular.module("myApp");sharedServices.service("Shared",function(){var a={},b={};return a.set=function(a,c){b[a]=c},a.setRoot=function(a){b.hasOwnProperty("applicationAccsessRoot")||(b.applicationAccsessRoot=[]),b.applicationAccsessRoot.push(a)},a.getRoot=function(){return b.applicationAccsessRoot},a.get=function(a){return b[a]},a.destloyByName=function(a){delete b[a]},a.destloy=function(){b=[]},a});var authServices=angular.module("AuthServices",["ngResource","ngCookies"]);authServices.factory("Auth",["$resource","$http","$location","$cookies","Utility","Shared",function(a,b,c,d,e,f){var g={};return g.login=function(a){var c=b.post("/auth/login",{mailAddress:a.mailAddress,password:a.password}).success(function(b){a.remember&&(d.remembertkn=a.remembertkn),f.set("id",b.data[0].user_id),f.set("userName",b.data[0].name),f.set("role",b.data[0].role_id)});return c},g.setLoginStatus=function(a){var d=b.post("api/setStatus",{id:a}).success(function(){c.path("/")}).error(function(a){e.errorSticky(a)});return d},g.isLogin=function(){var a=b.post("api/isLogin",{}).success(function(){return!0}).error(function(a){e.errorSticky(a)});return a},g.logout=function(){var a=b.post("auth/logout",{}).success(function(){c.path("/login")}).error(function(a){e.errorSticky(a)});return a},g}]),authServices.factory("AutoAuth",["$window","$http","$q",function(a,b,c){var d=c.defer();b.post("api/auth",{}).success(function(){return d.promise}).error(function(){a.location.href="https://"+location.host})}]);var modalService=angular.module("myApp");modalService.service("Modal",["$modal",function(a){var b=function(b,c){return a.open({templateUrl:c,backdrop:"static",scope:b})};return{open:b}}]);var mailServices=angular.module("myApp");mailServices.service("Mail",["$resource",function(a){var b={};return b.resource=a("https://api-gozaru9.c9.io/V1/mail/:site/",{site:"@site"}),b}]),angular.module("myApp").factory("d3Service",function(){return{d3:d3}});var locationServices=angular.module("myApp");locationServices.service("Location",["$location",function(a){var b={};return b.home=function(){a.path("/")},b.user=function(){a.path("/user")},b.query=function(){a.path("/query")},b.query=function(){a.path("/query/list")},b.querySet=function(){a.path("/query/set")},b.querySave=function(){a.path("/query/save")},b.segment=function(){a.path("/segment")},b.segmentControl=function(b){a.path("/segment/control/"+b)},b.trigger=function(){a.path("/scenario/trigger")},b.schedule=function(){a.path("/scenario/schedule")},b}]);var mainServices=angular.module("myApp");mainServices.service("Main",function(){var a={};return a.getUserIdFromList=function(a,b){return a[b].my._id},a.getTaskIdFromList=function(a,b,c){return a[b].taskList[c]._id},a.removeTaskByIndex=function(a,b,c){a[b].taskList.splice(c,1)},a.getProgressFromList=function(a,b,c){return a[b].taskList[c].progress},a.getContentsFromList=function(a,b,c){return a[b].taskList[c].contents},a});var customerServices=angular.module("CustomerServices",["ngResource"]);customerServices.factory("Customer",["$resource","Utility",function(a){var b={};return b.resource=a("/customer/:id/",{id:"@id"},{detail:{method:"GET",url:"custmoer/detail/:id",cache:!0},orders:{method:"GET",url:"custmoer/orders/:id",cache:!0}}),b}]);var scenarioServices=angular.module("ScenarioServices",["ngResource"]);scenarioServices.factory("Scenario",["$resource","$http","$q","Utility",function(a,b,c){var d={},e={schedule:{type:1,mode:0,title:"スケジュール型",addTitle:"",template:"views/scenario/schedule.html"},trigger:{type:2,mode:0,title:"トリガー型",addTitle:"",template:"views/scenario/trigger.html"}};return d.daysCondition=function(){for(var a=[],b=31,c=1;b>=c;c++)a.push({name:c,check:!1});return a.push({name:"最終日",check:!1}),a},d.resource=a("/scenario/:type/:id/",{id:"@id"},{list:{method:"GET",url:"scenario/list/:id",cache:!0},initializeData:{method:"GET",url:"scenario/initialize/:type/:id"},action:{method:"GET",url:"action/:name",cache:!0},save:{method:"POST",url:"scenario/save"},remove:{method:"DELETE",url:"scenario/:type/remove/:id"},valid:{method:"GET",url:"scenario/valid"},priority:{method:"POST",url:"scenario/priority"},typeCount:{method:"GET",url:"scenario/typecount"},executeplan:{method:"GET",url:"scenario/execute/plan"},bulkInvalid:{method:"GET",url:"scenario/bulkInvalid"},bulkEnable:{method:"GET",url:"scenario/bulkEnable"}}),d.getPageProp=function(a,b){var c=e[a];return c.addTitle=void 0===b?"登録":"更新",c.mode=void 0===b?1:2,c},d.validators={isSameName:function(a){return b.post("scenario/name/",a).then(function(a){return a.data.result.count>0?c.reject("exists"):!1})}},d.setActivePushItem=function(a,b,c,d){angular.forEach(a,function(a){return a.isPush?(c[d]=a[b],!1):void 0})},d.createCondtionString=function(a){var b="",c=a.length-1;return angular.forEach(a,function(a,d){b+=a.logicalname+"が["+a.condition.value1,""!==a.condition.value2&&(b+=","+a.condition.value2),b+="]"+a.selectedCondition.name,d!==c&&(b+="AND"===a.condition.where?" かつ ":" または ")}),b},d.getConditionDoc=function(a){var b=[];return angular.forEach(a,function(a){var c=[];angular.forEach(a,function(a){c.push({physicalname:a.physicalname,condition:a.condition,selectedCondition:a.selectedCondition})}),b.push(c)}),b},d}]);var segmentServices=angular.module("SegmentServices",["ngResource"]);segmentServices.factory("Segment",["$resource","$http","Utility",function(a){var b={};return b.resource=a("/segment/:id/",{id:"@id"},{getDoc:{method:"GET",url:"segment/getdoc"},saveDoc:{method:"POST",url:"segment/savedoc"},save:{method:"POST",url:"segment/save"},download:{method:"GET",url:"segment/:id/download"},remove:{method:"DELETE",url:"segment/remove/:id/:segment_document_id"},executeQuery:{method:"POST",url:"segment/execute"},useSegment:{method:"POST",url:"/segment/query/use"}}),b.pageProp=function(a){return void 0===a?{viewMode:1,pageTitle:"登録"}:{viewMode:2,pageTitle:"更新"}},b.setWhereProp=function(a,b){void 0===b?angular.forEach(a,function(a){a.where="AND"}):angular.forEach(a,function(a,c){var d=null===b[c]?"AND":b[c];a.where=d})},b.setListData=function(a,b,c){angular.forEach(b,function(b){angular.forEach(a,function(d,e){b==d.id&&(c.push(d),a.splice(e,1))})})},b.createExecuteInfo=function(a){var b=[],c={},d={};return angular.forEach(a,function(a){b.push(a.id),c[a.id]=a.where,Object.keys(a.tables).forEach(function(a){d.hasOwnProperty(a)||(d[a]=a)})}),{qIds:b,tables:d,conditionMap:c}},b.createSQL=function(a){var b="",c=a.length-1;return angular.forEach(a,function(a,d){b+="("+a.sql+") ",c!==d&&(b+=a.where)}),b},b.getTables=function(a){var b={};return angular.forEach(a,function(a){Object.keys(a.tables).forEach(function(a){b.hasOwnProperty(a)||(b[a]=a)})}),b},b.createDocData=function(a){var b="",c=a.length-1,d=[],e=[];return angular.forEach(a,function(a,f){b+="("+a.sql+") ",c!==f&&(b+=a.where),d.push(a.id),e.push(a.where)}),{condition:b,qIds:d,whereList:e}},b}]);var queryServices=angular.module("QueryServices",["ngResource"]);queryServices.factory("Query",["$resource","$http","Shared",function(a,b,c){var d={};return d.sql="",d.resource=a("/query",{id:"@id"},{getQuery:{method:"GET",url:"/query/get"},getList:{method:"GET",url:"/query/list"},getControlInit:{method:"GET",url:"/query/control/:id"},create:{method:"POST",url:"/query/create"},remove:{method:"DELETE",url:"/query/:id"},getUseSegment:{method:"GET",url:"/query/use/segment/:id"},executeQuery:{method:"POST",url:"/query/execute"}}),d.getContentsByColumsType=function(a){var b={inputType:""};return console.log(a),"INT"===a?b.inputType="number":"VARCHAR"===a?b.inputType="text":"DATETIME"===a&&(b.inputType="date"),b.inputType},d.createCondtionString=function(a){angular.forEach(a,function(a){a.selectedCondition.condtionString=void 0===a.condition.value2||""===a.condition.value2?a.condition.value1+""+a.selectedCondition.name:a.condition.value1+"から"+a.condition.value2+a.selectedCondition.name})},d.getTables=function(a){var b={};return angular.forEach(a,function(a){void 0===b[a.table.physicalname]&&(b[a.table.physicalname]=[]);var c={column:a.column.physicalname,conditionType:a.selectedCondition.value,values:a.condition};b[a.table.physicalname].push(c)}),b},d.getRefTabels=function(a){var b=[];return angular.forEach(a,function(a){b.push(a)}),b},d.getReturnURL=function(){var a=c.getRoot(),b=a.length,d=a[a.length-1],e="";if("query list"===d)e="/query/list";else if("query list"===d)e="/segment/control";else for(b;b>0;b--){if("query list"===a[b]){e="/query/list";break}if("segment control"===a[b]){e="/segment/control";break}}return e},d}]);var approachServices=angular.module("ApproachServices",["ngResource"]);approachServices.factory("Approach",["$resource","Utility",function(a){var b={};return b.resource=a("/approach/"),b.pageProp=function(a){return void 0===a?{viewMode:1,pageTitle:"登録"}:{viewMode:2,pageTitle:"更新"}},b.getInfomation=function(a){var b={};return 1===a?(b.title="1日の制限回数について",b.message="対象の顧客に対して1日に抽出対象とする回数になります。<br>複数のシナリオで抽出対象となる顧客の場合この回数以上は抽出されなくなります。"):2===a&&(b.title="1週間の制限回数について",b.message="対象の顧客に対して1週間に抽出対象とする回数"),b},b}]);var uesrServices=angular.module("UesrServices",["ngResource"]);uesrServices.factory("User",["$resource","$http","$q","Utility",function(a,b,c){var d={},e={regist:{type:1,title:"ユーザー登録"},edit:{type:2,title:"ユーザー更新"}};return d.resource=a("/user/:id",{id:"@id"},{create:{method:"POST",url:"user/create"},remove:{method:"GET",url:"user/delete"}}),d.validators={isSameMailAddress:function(a,d){return b.post("user/mail/",{user_id:a,mailaddress:d}).then(function(a){return a.data.result.count>0?c.reject("exists"):!1})}},d.createBirth=function(a,b,c){return""!==a&&""!==b&&""!==c?a+"-"+b+"-"+c:""},d.getPrefectures=function(){return[{value:"01",text:"北海道"},{value:"02",text:"青森"},{value:"03",text:"岩手"},{value:"04",text:"宮城"},{value:"05",text:"秋田"},{value:"06",text:"山形"},{value:"07",text:"福島"},{value:"08",text:"茨城"},{value:"09",text:"栃木"},{value:"10",text:"群馬"},{value:"11",text:"埼玉"},{value:"12",text:"千葉"},{value:"13",text:"東京"},{value:"14",text:"神奈川"},{value:"15",text:"新潟"},{value:"16",text:"富山"},{value:"17",text:"石川"},{value:"18",text:"福井"},{value:"19",text:"山梨"},{value:"20",text:"長野"},{value:"21",text:"岐阜"},{value:"22",text:"静岡"},{value:"23",text:"愛知"},{value:"24",text:"三重"},{value:"25",text:"滋賀"},{value:"26",text:"京都"},{value:"27",text:"大阪"},{value:"28",text:"兵庫"},{value:"29",text:"奈良"},{value:"30",text:"和歌山"},{value:"31",text:"鳥取"},{value:"32",text:"島根"},{value:"33",text:"岡山"},{value:"34",text:"広島"},{value:"35",text:"山口"},{value:"36",text:"徳島"},{value:"37",text:"香川"},{value:"38",text:"愛媛"},{value:"39",text:"高知"},{value:"40",text:"福岡"},{value:"41",text:"佐賀"},{value:"42",text:"長崎"},{value:"43",text:"熊本"},{value:"44",text:"大分"},{value:"45",text:"宮崎"},{value:"46",text:"鹿児島"},{value:"47",text:"沖縄"}]},d.getPageProp=function(a){return void 0===a?e.regist:e.edit},d.getSelectedUserIdAndML=function(a,b){for(var c=[],d=a.length,e=0;d>e;e++)a[e][b]&&c.push({_id:a[e]._id,mailAddress:a[e].mailAddress});return c},d}]);var roleServices=angular.module("RoleServices",["ngResource"]);roleServices.factory("Role",["$resource","Utility",function(a){var b={};return b.resource=a("/role/:id",{id:"@id"},{}),b}]);var accessServices=angular.module("AccessServices",["ngResource"]);accessServices.factory("Access",["$resource","Utility",function(a){var b={};return b.resource=a("/access/",{},{day:{method:"POST",url:"/access"},dayByUser:{method:"POST",url:"/access/user"}}),b}]);var bugServices=angular.module("BugServices",["ngResource"]);bugServices.factory("Bug",["$resource","Utility","Upload",function(a,b,c){var d={};return d.categoryList=[{name:"ダッシュボード",type:1},{name:"トリガーシナリオ管理",type:2},{name:"スケジュールシナリオ管理",type:3},{name:"セグメント管理",type:4},{name:"クエリー管理",type:5},{name:"アプローチ管理",type:6},{name:"ユーザー管理",type:7},{name:"操作履歴",type:8},{name:"その他",type:99}],d.resource=a("/bug/",{},{getByConditon:{method:"POST",url:"/bug"},resolve:{method:"GET",url:"/bug/resolve/:id"},save:{method:"POST",url:"/bug/save"},saveComment:{method:"POST",url:"/bug/save/comment"},getComment:{method:"GET",url:"/bug/comment/:id"},vote:{method:"GET",url:"/bug/vote/:id"},download:{method:"GET",url:"/bug/download/:id"}}),d.commentSaveAndUpload=function(a,b,d){c.upload({url:"/bug/save/comment/upload/",file:a,data:{data:b}}).success(function(){d(null)}).error(function(){d("通信エラー")})},d.saveAndUpload=function(a,b,d){c.upload({url:"/bug/save/upload/",file:a,data:{data:b}}).success(function(){d(null)}).error(function(){d("通信エラー")})},d.addViewInfo=function(a){angular.forEach(a,function(a){switch(a.category){case 1:a.category_name="ダッシュボード";break;case 2:a.category_name="トリガーシナリオ管理";break;case 3:a.category_name="スケジュールシナリオ管理";break;case 4:a.category_name="セグメント管理";break;case 5:a.category_name="クエリー管理";break;case 6:a.category_name="アプローチ管理";break;case 7:a.category_name="ユーザー管理";break;case 8:a.category_name="操作履歴";break;default:a.category_name="その他"}a.type_name=1===a.type?"要望":"バグ",a.resolve_name=1===a.resolve?"解決":"未解決"})},d}]);var azureServices=angular.module("AzureServices",["ngResource"]);azureServices.factory("Azure",["$resource","$http","Shared",function(a){var b={};return b.resource=a("/customer/:id/",{id:"@id"},{recomender:{method:"GET",url:"/azure/recomender/:id"}}),b}]);var myApp=angular.module("myApp");myApp.controller("HeadCtrl",["$scope","Auth","Modal","Shared","Mail",function(a,b,c,d,e){a.initialize=function(){a.isShowUser=1==d.get("role")?!0:!1},a.addMenber=function(){a.modalParam={mailaddress:"",execute:f},a.modalInstance=c.open(a,"partials/memberAdd.html")},a.logout=function(){d.destloy(),b.logout().then(function(){$("#view").addClass("view-animate-container-wide"),$("#view").removeClass("view-animate-container"),a.$emit("logoutConplete")})};var f=function(){e.resource.save({site:"niikawa"}).$promise.then(function(){a.modalInstance.close()})}}]),myApp.directive("myHeader",function(){return{restrict:"E",replace:!0,controller:"HeadCtrl",templateUrl:"partials/common/header.html",link:function(a){a.isOpenMenu=!0,$("#view").removeClass("view-animate-container-wide"),$("#view").addClass("view-animate-container"),a.openClose=function(){a.isOpenMenu=!a.isOpenMenu,a.isOpenMenu?($("#view").removeClass("view-animate-container-wide"),$("#view").addClass("view-animate-container")):($("#view").removeClass("view-animate-container"),$("#view").addClass("view-animate-container-wide"))}}}});var myApp=angular.module("myApp");myApp.directive("autoCompleteDirective",function(){return{restrict:"E",scope:{selectedItem:"=",itemList:"=",execute:"&",namePropertie:"@",appendString:"@",showLabel:"=",selectByList:"=",selectName:"="},template:'<form class="navbar-form navbar-left"><input ng-show="!isLabel" class="form-control d-complete-input" ng-model="selectName"><span ng-show="isLabel && selectName.length != 0" ng-click="changeElement()">{{appendString}}{{selectName}}</span><ul class="complete-list" ng-show="isFocus"><li ng-repeat="item in itemList" ng-click="click($event, item)" >{{item[namePropertie]}}</li></ul></form>',replace:!0,link:function(a,b){a.selectName="",a.isFocus=!1,a.isLabel=!1;var c=[];a.$watch("itemList",function(b,d){if(void 0!==b&&void 0!==d){if(console.log("watch itemList"),b.length===d.length)return!1;b.length>d.length?c=angular.copy(b):b.length<d.length&&(c=angular.copy(d))}else void 0!==a.itemList&&(console.log("set initialize data"),angular.copy(a.itemList,c))}),b.find("input").on("focus",function(){0<a.itemList.length&&a.$apply(function(){a.isFocus=!0})}),b.find("input").on("blur",function(){var d=setInterval(function(){a.$apply(function(){if(a.selectByList){for(var d=c.length,e=0===a.selectName.length?!0:!1,f=0;d>f;f++)if(a.selectName===c[f][a.namePropertie]){e=!0;break}e?b.find("input").removeClass("auto-complete-item-error"):b.find("input").addClass("auto-complete-item-error"),a.isFocus=!1}}),clearInterval(d)},300)}),b.find("input").on("keyup",function(){0===c.length&&angular.copy(a.itemList,c);var b=[];if(0<a.itemList.length&&(a.isFocus=!0),0===a.selectName.length)angular.copy(c,b);else for(var d=c.length,e=0;d>e;e++)-1!==c[e][a.namePropertie].indexOf(a.selectName)&&b.push(angular.copy(c[e]));a.$apply(function(){angular.copy(b,a.itemList)})}),a.click=function(c,d){c.preventDefault(),c.stopPropagation(),angular.copy(d,a.selectedItem),b.find("input").removeClass("auto-complete-item-error"),a.isFocus=!1,void 0!==a.execute&&a.execute(),a.showLabel&&(a.isLabel=!0),a.selectName=d[a.namePropertie]},a.changeElement=function(){angular.copy(c,a.itemList),a.isLabel=!1,b.find("input").focus()}}}});var myApp=angular.module("myApp");myApp.directive("spinnerDirective",function(){return{restrict:"E",scope:{is:"=",src:"@"},template:'<div ng-show="is"><img ng-src="{{src}}"></div>',link:function(){}}});var myApp=angular.module("myApp");myApp.directive("mapDirective",["Utility",function(a){return{restrict:"AE",scope:{mapClass:"@",overlayClass:"@"},link:function(b,c,d){function e(b){var c=new GMaps({div:"#"+d.id,lat:b.coords.latitude,lng:b.coords.longitude,zoom:18});c.addMarker({lat:b.coords.latitude,lng:b.coords.longitude,animation:google.maps.Animation.BOUNCE,click:function(){var d=new google.maps.Geocoder,e=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);d.geocode({latLng:e},function(b,d){d==google.maps.GeocoderStatus.OK&&b[1]?(a.info(b[1].formatted_address),c.setZoom(17)):a.warning("対象の住所は存在しません")})}})}function f(b){var c="";switch(b.code){case b.POSITION_UNAVAILABLE:c="位置情報の取得ができませんでした。";break;case b.PERMISSION_DENIED:c="位置情報取得の使用許可がされませんでした。";break;case b.PERMISSION_DENIED_TIMEOUT:c="位置情報取得中にタイムアウトしました。"}a.errorSticky(c)}return void 0===d.id?!1:navigator.geolocation?(c.addClass(b.mapClass),void navigator.geolocation.getCurrentPosition(e,f)):(a.errorSticky("ご利用のブラウザでは位置情報を取得できません。"),!1)}}}]);var myApp=angular.module("myApp");myApp.directive("drawerMenuDirective",function(){return{restrict:"E",scope:{menuList:"=",position:"@"},template:'<nav class="hi-icon-effect-8 drawer-menu"><a ng-repeat="item in itemList" style="{{item.style}}" class="drawer-menu-item" ng-href={{item.link}}><i ng-if="item.fa" class="fa {{item.fa}} fa-3x"></i><span ng-if="item.s">{{item.s}}</span></a></nav>',link:function(a,b){void 0===a.menuList&&console.log(a.menuList);var c=3.14,d=c-.2,e=5,f=1,g=50,h="fa-bars",i="fa-times",j=0,k=0,l=1e3;a.itemList=[],a.isOpen=!1;var m={fa:h,link:"",style:"#/"};a.itemList.push(m),b.on("click",function(){a.$apply(function(){if(a.isOpen)a.itemList[0].fa=h,a.itemList.splice(1,a.itemList.length-1),1===f&&(a.itemList[0].style="transform: translate(0);"),b.children("nav").addClass("drawer-menu-right"),b.children("nav").removeClass("drawer-menu-center");else{a.itemList[0].fa=i,b.children("nav").removeClass("drawer-menu-right"),b.children("nav").addClass("drawer-menu-center");var m=["","/#/segment","/#/scenario","/#/approach","/#/user"],n=["D","SE","SC","AP","US"];if(1===f)for(var o=1;e>=o;o++){var p=(c-d)/2+d/(e-1)*(o-1);j=75*Math.cos(p),k=75*Math.sin(p)-(o-1)*g-g/2;var q=l+400*o,r="transition-timing-function:cubic-bezier(0.935, 0.000, 0.340, 1.330);transition-duration: "+q+"ms;transform: translate3d("+j+"px,"+k+"px, 0);",s={s:n[o-1],link:m[o-1],style:r};a.itemList.push(s)}}a.isOpen=!a.isOpen})})}}});var dDSharedServices=angular.module("myApp");dDSharedServices.service("DDShared",function(){var a={},b=0,c={},d=0,e=!1;return a.setFrom=function(a){c=a},a.getFrom=function(){return c},a.getFromCopyByIndex=function(a){return angular.copy(c[a])},a.getCopyFrom=function(){return angular.copy(c)},a.setOrverIndex=function(a){b=a},a.getOrverIndex=function(){return b},a.getBeforePosition=function(){return d},a.setBeforePosition=function(a){d=a},a.isMoveDown=function(){return e},a.setMove=function(a){e=a>0?!0:!1},a.clear=function(){b=0,c={}},a});var myApp=angular.module("myApp");myApp.directive("dragItemDirective",["DDShared",function(a){return{restrict:"AE",transclude:!1,require:"^ngModel",scope:{dragindex:"="},link:function(b,c,d,e){c.attr("draggable",!0),c.attr("data-index",b.dragindex),c.on("dragstart",function(b){var d=b.target.dataset.index,f=c.html();b.originalEvent.dataTransfer.setData("item",f),b.originalEvent.dataTransfer.setData("itemIndex",d),a.setFrom(e.$modelValue),a.setBeforePosition(0)})}}}]),myApp.directive("dropDirective",["DDShared",function(a){return{restrict:"A",scope:{dropLineName:"@"},require:"^ngModel",link:function(b,c,d,e){var f=void 0===b.dropLineName||""===b.dropLineName?"line":b.dropLineName;c.on("dragenter",function(){c.addClass("ui-drop-target")}),c.on("dragover",function(b){if(b.preventDefault(),void 0!==b.target.dataset.index){a.setOrverIndex(b.target.dataset.index);var c=Math.max.apply(null,[document.body.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.documentElement.clientHeight]),d=window.innerHeight||document.body.clientHeight||0;if(c>d){var e=b.target.getBoundingClientRect().top+$(b.target).position().top+50,f=0;if(0!=a.getBeforePosition()&&a.getBeforePosition()!=e){var g=$(b.target).height()+15;f=a.getBeforePosition()>e?-g:g,a.setMove(f),a.setBeforePosition(e-f),$(window).scrollTop($(window).scrollTop()+f)}else a.setBeforePosition(e)}}b.originalEvent.dataTransfer.dropEffect="move"}),c.on("dragleave",function(){c.removeClass("ui-drop-target")}),c.on("drop",function(c){c.stopPropagation(),a.setBeforePosition(0);var g=c.originalEvent.dataTransfer.getData("itemIndex"),h={},i=0===e.$modelValue.length?0:a.getOrverIndex();if(g===i)return!1;angular.isArray(a.getFrom())?(h=a.getFromCopyByIndex(g),a.getFrom().splice(g,1)):h=a.getCopyFrom(),void 0!==h&&e.$modelValue.splice(i,0,h);for(var j=e.$modelValue.length,k=0;j>k;k++)e.$modelValue[k][f]=k+1;var l={to:{},from:{},remove:{},isSameContainer:!1,areaKey:d.dropAreaKey,insertLine:i};l.to=e.$modelValue,l.from=a.getFrom(),l.remove=h,l.isSameContainer=l.to==l.from,b.$emit("dropItemComplete",l),console.log(l),b.$$phase||b.$apply()})}}}]),myApp.directive("dropJoinDirective",["DDShared",function(a){return{restrict:"A",scope:{dropJoinIndex:"="},require:"^ngModel",link:function(b,c,d,e){c.on("dragenter",function(){c.addClass("ui-drop-target")}),c.on("dragover",function(b){b.preventDefault(),void 0!==b.target.dataset.index&&a.setOrverIndex(b.target.dataset.index),b.originalEvent.dataTransfer.dropEffect="move"}),c.on("dragleave",function(){c.removeClass("ui-drop-target")}),c.on("drop",function(c){if(c.stopPropagation(),e.$modelValue==a.getFrom())return!1;var d=c.originalEvent.dataTransfer.getData("itemIndex"),f=a.getFromCopyByIndex(d);if(void 0===f)return!1;var g=!1;if(console.log(e.$modelValue),angular.isArray(e.$modelValue)){if(e.$modelValue[0].hasOwnProperty("table")&&e.$modelValue[0].hasOwnProperty("column")&&e.$modelValue[0].table.physicalname==f[0].table.physicalname&&e.$modelValue[0].column.physicalname==f[0].column.physicalname)return!1;g=!0}if(angular.isArray(a.getFrom())?a.getFrom().splice(d,1):f=a.getCopyFrom(),e.$modelValue==a.getFrom())return console.log(d),e.$modelValue.splice(d,d+1,f,e.$modelValue[d+1]),!1;if(g)e.$modelValue.push(angular.isArray(f)?f[0]:f);else{var h=[];h.push(e.$modelValue),h.push(f)}e.$modelValue.isJoin=e.$modelValue.length>1?!0:!1,console.log(e.$modelValue),b.$$phase||b.$apply(),console.log("drop join complete")})}}}]);var myApp=angular.module("myApp");myApp.directive("pushDirective",function(){return{restrict:"A",scope:{list:"=",pushInfo:"=info",active:"=",activekey:"@",multiple:"="},link:function(a,b){if(b.css({cursor:"pointer"}),void 0!==a.active){var c=!1;"boolean"==typeof a.active?(a.pushInfo.isPush=a.active,c=a.active):("string"==typeof a.active||"number"==typeof a.active)&&a.pushInfo[a.activekey]==a.active&&(a.pushInfo.isPush=!0,c=!0),c&&b.addClass("push-active")}else a.pushInfo.isPush=!1;b.on("click",function(){a.$apply(function(){b.hasClass("push-active")?(a.pushInfo.isPush=!1,b.removeClass("push-active")):(void 0!==a.multiple&&a.multiple||(b.parent().children().removeClass("push-active"),angular.forEach(a.list,function(a){a.isPush=!1})),a.pushInfo.isPush=!0,b.addClass("push-active"))})})}}});var myApp=angular.module("myApp");myApp.directive("refineDirective",function(){return{restrict:"A",scope:{refineItem:"=",namePropertie:"@",keyword:"=",execute:"&"},replace:!0,link:function(a,b){var c=[];b.on("keyup",function(){0===c.length&&angular.copy(a.refineItem,c);var b=[];if(void 0===a.keyword||0===a.keyword.length)angular.copy(c,b);else for(var d=c.length,e=a.namePropertie.split("|"),f=[],g=Object.keys(c[0]),h=0;d>h;h++)angular.forEach(e,function(d){-1!==c[h][d].indexOf(a.keyword)&&void 0===f[c[h][g[0]]]&&(b.push(angular.copy(c[h])),f[c[h][g[0]]]=!0)});a.$apply(function(){angular.copy(b,a.refineItem)})})}}});var myApp=angular.module("myApp");myApp.directive("closeButtonDirecitve",function(a,b){return{restrict:"E",scope:{execute:"&"},template:'<button ng-if="isShowMine" class="close-button" ng-click="click()"><i class="fa fa-times"></i></button>',link:function(c){c.isShowMine=3!=a.get("role")?!0:!1,c.click=function(){b.confirmAlert(c.execute)}}}});var myApp=angular.module("myApp");myApp.directive("saveButtonDirecitve",function(a){return{restrict:"E",scope:{is:"=",execute:"&",name:"@"},template:'<button ng-if="is" class="close-button" ng-click="click()">{{name}}</button>',link:function(b){b.isShowMine=3!=a.get("role")?!0:!1,b.click=function(){b.execute()}}}});var myApp=angular.module("myApp");myApp.directive("linkButtonDirecitve",function(a){return{restrict:"E",scope:{href:"@",name:"@"},template:'<a ng-if="isShowMine" class="btn btn-default" ng-href="/#/{{href}}">{{name}}</a> ',link:function(b){b.isShowMine=3!=a.get("role")?!0:!1,b.click=function(){b.execute()}}}});var myApp=angular.module("myApp");myApp.directive("conditionDirective",function(a){return{restrict:"EA",scope:{conditionAppend:"=",screenType:"@"},template:'指定した値<select ng-model="mySlected" class="form-control" ng-options="item as item.name for item in selectItems" ng-required="true"></select>ものを条件とする<div ng-if="isOneInput"><input type="text" name="{{conditionAppend.column.physicalname}}" class="form-control" ng-model="conditionAppend.condition.value1" ng-keyup="check()" ng-required="true"><div ng-if="conditionAppend.error" class="item-error-box"><p class="item-error">{{conditionAppend.message}}</p></div></div><div ng-if="isTextArea"><textarea class="form-control" ng-model="conditionAppend.condition.value1" ng-required="true"></textarea></div><div ng-if="isTwoInput"><input type="text" class="form-control" ng-model="conditionAppend.condition.value1" ng-keyup="check()" ng-required="true">～<input type="text" class="form-control" ng-model="conditionAppend.condition.value2" ng-keyup="check()" ng-required="true"></div>',link:function(b,c){var d=function(){b.isOneInput=!0,b.isTextArea=!1,b.isTwoInput=!1},e=function(){b.isOneInput=!1,b.isTextArea=!0,b.isTwoInput=!1},f=function(){b.isOneInput=!1,b.isTextArea=!1,b.isTwoInput=!0};b.selectItems=1==b.screenType?[{name:"に等しい",value:1,execute:d,symbol:"="},{name:"以上",value:2,execute:d,symbol:">="},{name:"以下",value:3,execute:d,symbol:"<="},{name:"を超える",value:4,execute:d,symbol:">"},{name:"未満",value:5,execute:d,symbol:"<"},{name:"の間",value:6,execute:f,symbol:"BETWEEN"}]:[{name:"に等しい",value:1,execute:d,symbol:"="},{name:"以上",value:2,execute:d,symbol:">="},{name:"以下",value:3,execute:d,symbol:"<="},{name:"を超える",value:4,execute:d,symbol:">"},{name:"未満",value:5,execute:d,symbol:"<"},{name:"の間",value:6,execute:f,symbol:"BETWEEN"},{name:"を含む",value:7,execute:e,symbol:"IN"},{name:"を含まない",value:8,execute:e,symbol:"NOT IN"},{name:"から始まる",value:9,execute:d,symbol:"LIKE"},{name:"で終わる",value:10,execute:d,symbol:"LIKE"},{name:"を一部に持つ",value:11,execute:d,symbol:"LIKE"}],b.isOneInput=!1,b.isTextArea=!1,b.isTwoInput=!1,void 0===b.conditionAppend.selectedCondition?(b.conditionAppend.selectedCondition={name:"",value:"",symbol:""},b.conditionAppend.condition={value1:"",value2:"",where:"AND"}):angular.forEach(b.selectItems,function(a){return a.value===b.conditionAppend.selectedCondition.value?(b.mySlected=a,b.conditionAppend.selectedCondition.name=b.mySlected.name,b.conditionAppend.selectedCondition.value=b.mySlected.value,
b.conditionAppend.selectedCondition.symbol=b.mySlected.symbol,a.execute(),!1):void 0}),c.find("select").on("change",function(){b.conditionAppend.selectedCondition.name=b.mySlected.name,b.conditionAppend.selectedCondition.value=b.mySlected.value,b.conditionAppend.selectedCondition.symbol=b.mySlected.symbol,b.$apply(function(){b.mySlected.execute()})}),b.check=function(){var c="";c=void 0===b.conditionAppend.column?b.conditionAppend.type:b.conditionAppend.column.type;var d=b.conditionAppend.condition.value1;if("bigint"===c||"int"===c||"number"===c)void 0===d?(b.conditionAppend.error=!1,b.conditionAppend.message=""):isFinite(parseInt(d,10))?(b.conditionAppend.error=!1,b.conditionAppend.message=""):(b.conditionAppend.error=!0,b.conditionAppend.message="数値で入力してください");else if("datetime"===c||"smalldatetime"===c)if(void 0===d)b.conditionAppend.error=!1,b.conditionAppend.message="";else{var e=d.split("-");if(3!==e.length)b.conditionAppend.error=!0,b.conditionAppend.message="日付はYYYY-MM-DDで入力してください";else{var f=a.moment(d);f.isValid()?(b.conditionAppend.error=!1,b.conditionAppend.message=""):(b.conditionAppend.error=!0,b.conditionAppend.message="有効な日付ではありません")}}}}}});var myApp=angular.module("myApp");myApp.directive("autoCompleteFaDirective",function(){return{restrict:"E",scope:{selectedItem:"=",itemList:"=",execute:"&",clickExecute:"&",namePropertie:"@",appendString:"@",showLabel:"=",selectByList:"=",selectName:"=",addonString:"@"},template:'<div class="input-group"><span class="input-group-addon">{{addonString}}</span><input ng-show="!isLabel" class="form-control form-control-add-fa2 " ng-model="selectName"><span ng-show="isLabel && selectName.length != 0" ng-click="changeElement()">{{appendString}}{{selectName}}</span><ul class="complete-list" ng-show="isFocus"><li ng-repeat="item in itemList" ng-click="click($event, item)" >{{item[namePropertie]}}</li></ul><span class="input-group-addon question"><i class="fa fa-plus fa-2x" ng-click="clickI()"></i></span>',replace:!0,link:function(a,b){a.selectName="",a.isFocus=!1,a.isLabel=!1;var c=[];a.$watch("itemList",function(b,d){if(void 0!==b&&void 0!==d){if(console.log("watch itemList"),b.length===d.length)return!1;b.length>d.length?c=angular.copy(b):b.length<d.length&&(c=angular.copy(d))}else void 0!==a.itemList&&(console.log("set initialize data"),angular.copy(a.itemList,c))}),b.find("input").on("focus",function(){0<a.itemList.length&&a.$apply(function(){a.isFocus=!0})}),b.find("input").on("blur",function(){var d=setInterval(function(){a.$apply(function(){if(a.selectByList){for(var d=c.length,e=0===a.selectName.length?!0:!1,f=0;d>f;f++)if(a.selectName===c[f][a.namePropertie]){e=!0;break}e?b.find("input").removeClass("auto-complete-item-error"):b.find("input").addClass("auto-complete-item-error"),a.isFocus=!1}}),clearInterval(d)},300)}),b.find("input").on("keyup",function(){0===c.length&&angular.copy(a.itemList,c);var b=[];if(0<a.itemList.length&&(a.isFocus=!0),0===a.selectName.length)angular.copy(c,b);else for(var d=c.length,e=0;d>e;e++)-1!==c[e][a.namePropertie].indexOf(a.selectName)&&b.push(angular.copy(c[e]));a.$apply(function(){angular.copy(b,a.itemList)})}),a.click=function(c,d){c.preventDefault(),c.stopPropagation(),angular.copy(d,a.selectedItem),b.find("input").removeClass("auto-complete-item-error"),a.isFocus=!1,void 0!==a.execute&&a.execute(),a.showLabel&&(a.isLabel=!0),a.selectName=d[a.namePropertie]},a.changeElement=function(){angular.copy(c,a.itemList),a.isLabel=!1,b.find("input").focus()},a.clickI=function(){angular.copy(c,a.itemList),a.isFocus=!1,a.clickExecute()}}}});var myApp=angular.module("myApp");myApp.controller("CalendarCtrl",["$scope","Calendar","Utility",function(a,b,c){a.calendarList=[],a.calendarofMonthList=[],a.isWeek=!1,a.isMonth=!1;var d=!1;a.initialize=function(){b.resource.get().$promise.then(function(b){a.isWeek=!0,a.calendarList=b.data})},a.nextDay=function(){if(!d){d=!0;var e=Object.keys(a.calendarList),f=c.moment(e[e.length-1]).format("YYYY-MM-DD"),g=c.addDay(f,1).format("YYYY-MM-DD");b.resource.oneDay({day:g}).$promise.then(function(b){delete a.calendarList[Object.keys(a.calendarList)[0]];var c=Object.keys(b.data);a.calendarList[c]=b.data[c],d=!1})}},a.deforeDay=function(){if(!d){d=!0;var e=c.moment(Object.keys(a.calendarList)[0]).format("YYYY-MM-DD"),f=c.subtractDay(e,1).format("YYYY-MM-DD");b.resource.oneDay({day:f}).$promise.then(function(b){var c=Object.keys(a.calendarList);delete a.calendarList[c[c.length-1]];var e=Object.keys(b.data),f={};f[e]=b.data[e],Object.keys(a.calendarList).forEach(function(b){f[b]=a.calendarList[b]}),a.calendarList=f,d=!1})}},a.showWeek=function(){d||(d=!0,b.resource.get().$promise.then(function(b){d=!1,a.isWeek=!0,a.isMonth=!1,a.calendarList=b.data}))},a.showMonth=function(){if(!d){d=!0;var e=Object.keys(a.calendarList),f=c.moment(e[e.length-1]).format("YYYY"),g=c.moment(e[e.length-1]).format("MM");b.resource.month({year:f,month:g}).$promise.then(function(b){d=!1,a.isMonth=!0,a.isWeek=!1,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}},a.nextMonth=function(){if(!d){d=!0;var e=a.year+"/"+a.month+"/01",f=c.addMonth(e,1).format("YYYY-MM"),g=f.split("-");b.resource.month({year:g[0],month:g[1]}).$promise.then(function(b){d=!1,a.isWeek=!1,a.isMonth=!0,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}},a.deforeMonth=function(){if(!d){d=!0;var e=a.year+"/"+a.month+"/01",f=c.subtractMonth(e,1).format("YYYY-MM"),g=f.split("-");b.resource.month({year:g[0],month:g[1]}).$promise.then(function(b){d=!1,a.isWeek=!1,a.isMonth=!0,a.calendarofMonthList=b.data,a.year=b.year,a.month=b.month})}}}]),myApp.factory("Calendar",["$resource","Utility",function(a){var b={};return b.resource=a("/calendar/",{},{oneDay:{method:"GET",url:"calendar/one/:day"},month:{method:"GET",url:"calendar/:year/:month"}}),b}]),myApp.directive("calendarDirective",function(a){return{restrict:"E",templateUrl:"../../partials/calendar.html",controller:"CalendarCtrl",replace:!0,link:function(b){b.showCircle=!1,b.enterCircle=function(){b.showCircle=!0},b.leaveCircle=function(){b.showCircle=!1},b.isTrigger=function(a){return 1===a},b.isScSingle=function(a){return 2===a},b.isScPriod=function(a){return 3===a},b.isHoliday=function(a){return"0sun"==a},b.isHolidayToWeek=function(b){return 0==a.moment(b).format("e")}}}});var myApp=angular.module("myApp");myApp.directive("myValidators",function(){return{require:"ngModel",scope:{myValidators:"="},link:function(a,b,c,d){var e=a.myValidators||{};angular.forEach(e,function(a,b){d.$validators[b]=a})}}}),myApp.directive("myAsyncValidators",function(){return{require:"ngModel",scope:{myAsyncValidators:"="},link:function(a,b,c,d){var e=a.myAsyncValidators||{};angular.forEach(e,function(a,b){d.$asyncValidators[b]=a})}}});var myApp=angular.module("myApp");myApp.directive("d3Bar",["d3Service","$parse",function(a,b){var c=a.d3;return{restrict:"EAC",scope:{data:"=",key:"@",valueProp:"@",label:"@"},link:function(a,d){var e=c.select(d[0]).append("svg").style("width","100%"),f=c.scale.category20(),g={},h=b(a.key||"id"),i=b(a.valueProp||"value"),j=b(a.label||"name");a.$watchCollection("data",function(){if(a.data){var b=e.selectAll("g.data-group").data(a.data,h),d=b.enter().append("g").classed("data-group",!0).each(function(b){var d=c.select(this);g[h(b)]=a.$watch(function(){return i(b)},function(a){d.select("rect").attr("width",a)})});d.append("rect").attr("x",130).attr("height",18).attr("fill",function(a){return f(a.name)}),d.append("text").text(j).attr("height",15),b.exit().each(function(a){var b=h(a);g[b](),delete g[b]}).remove(),b.each(function(a,b){var d=c.select(this);d.select("rect").attr("y",25*b),d.select("text").attr("y",25*b+15)})}})}}}]);var myApp=angular.module("myApp");myApp.directive("lineChart",["d3Service","$parse","$window",function(a,b,c){var d=a.d3;return{restrict:"EA",scope:{data:"=",type:"@",headerLabel:"=",legendLabel:"="},link:function(a,b){function e(a){return-1===k.indexOf(a)?k[0]:a}function f(){if(void 0!==a.legendLabel){var c=angular.isArray(a.legendLabel)?a.legendLabel.length:0;if(0!==c){var e={width:"100%",height:15*c},f=d.select(b[0]).append("svg").attr("width",e.width).attr("height",e.height);f.selectAll("rect").data(a.legendLabel).enter().append("rect").attr("class","pull-right").attr("width",50).attr("height",5).attr("x",i.width()-150).attr("y",function(a,b){return 20*b}).attr("fill",function(a,b){return j[b]}),f.selectAll("text").data(a.legendLabel).enter().append("text").text(function(a){return a}).attr("x",function(){return i.width()-250}).attr("y",function(a,b){return 0===b?10:5*b+20})}}}function g(c){var f={width:i.width(),height:i.height()/2},g=f.width-l.left-l.right-50,h=f.height-l.top-l.bottom,j=d.time.scale().range([0,g]),k=d.scale.linear().range([h,0]),n=d.svg.axis().scale(j).orient("bottom").innerTickSize(-h).outerTickSize(0).tickFormat(d.time.format("%Y/%m")),o=d.svg.axis().scale(k).orient("left").innerTickSize(-g).outerTickSize(0),p=d.select(b[0]).append("svg").attr("width","100%").attr("height",f.height).append("g").attr("transform","translate("+l.left+","+l.top+")"),q=e(a.type),r=d.svg.line().x(function(a){return j(a.date)}).y(function(a){return k(a.price)}).interpolate(q);angular.forEach(a.data,function(a,b){a.forEach(c?function(a){a.date=a.date,a.price=+a.price}:function(a){a.date=m(a.date),a.price=+a.price});var e="line-avg";0===b&&(e="line-main",j.domain(d.extent(a,function(a){return a.date})).nice(),k.domain(d.extent(a,function(a){return a.price})).nice(),p.append("g").attr("class","x axis").attr("transform","translate(0, "+(f.height-l.top-l.bottom)+")").call(n).selectAll("text").attr("transform","rotate (-70)").attr("dx","-5em").attr("dy","-0.1em").style("text-anchor","start"),p.append("g").attr("class","y axis").call(o).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".7em").style("text-anchor","end")),p.append("path").datum(a).attr("class",e).attr("d",r)})}function h(){b.children("svg").length>0&&b.children("svg").remove()}var i=angular.element(c),j=["#FF8C00","#A9A9A9"],k=["linear","linear-closed","step","step-before","step-after","basis","basis-open","basis-close","bundle","cardinal","cardinal-open","cardinal-close","monotone"],l={top:40,right:40,bottom:70,left:90},m=d.time.format("%Y/%m").parse;a.$watchCollection("data",function(){if(void 0!==a.headerLabel&&""!==a.headerLabel){b.children("p").length>0&&b.children("p").remove();var c='<p class="line-title">'+a.headerLabel+"</p>";b.append(c)}a.data&&(h(),f(!1),g(!1))}),i.on("resize",function(){h(),f(!0),g(!0)})}}}]);